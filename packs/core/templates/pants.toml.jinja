{%- set langs = languages | default([]) -%}
{%- set feats = features | default([]) -%}
{%- set backend_packages = [
  "pants.backend.shell",
  "pants.backend.experimental.visibility",
  "pants.backend.python",
  "pants.backend.python.lint.ruff",
  "pants.backend.python.typecheck.pyright",
] -%}
{%- if "typescript" in langs -%}
{%- set backend_packages = backend_packages + [
  "pants.backend.experimental.javascript",
  "pants.backend.experimental.typescript",
] -%}
{%- endif -%}
{%- if "rust" in langs -%}
{%- set backend_packages = backend_packages + ["pants.backend.experimental.rust"] -%}
{%- endif -%}
{%- if "go" in langs -%}
{%- set backend_packages = backend_packages + ["pants.backend.experimental.go"] -%}
{%- endif -%}
{%- if "docker" in feats -%}
{%- set backend_packages = backend_packages + ["pants.backend.docker"] -%}
{%- endif -%}
{%- set root_patterns = [
  "/services/**/src",
  "/services/**/tests",
] -%}
{%- if "go" in langs -%}
{%- set root_patterns = root_patterns + [
  "/services/**/cmd",
  "/services/**/internal",
] -%}
{%- endif -%}
{%- set root_patterns = root_patterns + [
  "/shared/**/src",
  "/shared/**/tests",
  "/shared/**/contracts",
  "/tools/**/src",
  "/tools/**/tests",
  "/tools/forbidden_imports",
  "/scripts",
  "/docs",
] -%}
[GLOBAL]
pants_version = "2.30.0"

backend_packages = [
{%- for backend in backend_packages %}
  "{{ backend }}",
{%- endfor %}
]

[source]
root_patterns = [
{%- for root in root_patterns %}
  "{{ root }}",
{%- endfor %}
]

[python]
interpreter_constraints = ["CPython>=3.12,<3.15"]

[python-infer]
unowned_dependency_behavior = "error"

[ruff]
config = ".ruff.toml"

[pyright]
config = "pyrightconfig.json"
